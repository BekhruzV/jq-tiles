/*jshint expr:true */(function(){function e(e,t,n){var r=(new Array(++t-e)).join(".").split(".").map(function(t,n){return e+n});return n?r.map(function(e){return[Math.random(),e]}).sort().map(function(e){return e[1]}):r}var t={x:4,y:4,slider:!1,effect:"default",fade:!0,random:!1,reverse:!1,limit:!1,rewind:!1,loop:!0,auto:!0,sliderSpeed:3e3,tileSpeed:1e3,cssSpeed:300};$.fn.tiles=function(n){var r=$.extend({},t,n);return $("body").addClass("tiles-preload"),$(window).load(function(){$("body").removeClass("tiles-preload")}),this.each(function(){var t=$(this),n="tiles-"+r.effect,i=r.x*r.y;t.is("img")||$.error("Selector can only contain images.");var s=$('<div class="tiles-wrap"/>'),u=[],a;(new Array(i)).join(".").split(".").forEach(function(e,t){u.push('<div class="tiles-tile '+n+'-normal"/>')}),a=$(u.join("")),a.addClass("tiles-x"+r.x+" tiles-y"+r.y),a.filter(":odd").addClass("tiles-odd"),a.filter(":even").addClass("tiles-even"),s.insertAfter(t),s.append(t,a),t.one("load",function(){var e=t.width(),n=t.height();s.width(e).height(n),a.css({width:e/r.x,height:n/r.y,backgroundImage:"url("+t.attr("src")+")"}),a.each(function(){var e=$(this),t=e.position();e.css("backgroundPosition",-t.left+"px "+ -t.top+"px")})}),t[0].complete&&t.trigger("load"),t.on("toggleTiles",function(s,u){u=$.extend(!0,{toggle:!0,reset:!1,cb:$.noop},u);var f=e(0,i,r.random),l=~~(r.tileSpeed/i);if(r.limit){var c=f.length/(100/r.limit);r.reverse?f.splice(0,c):f.splice(c,f.length)}a.removeClass("tiles-reset"),u.reset&&a.addClass("tiles-reset"),(r.reverse?f.reverse():f).forEach(function(e,t){function i(t,r){setTimeout(function(){a.addClass("tiles-animated"),a.eq(e).toggleClass(n+"-toggle",t)},r)}i(u.toggle,u.reset?0:t*l),r.rewind&&i(!1,t*l+r.cssSpeed/(100/r.rewind))});var h=u.reset?0:r.tileSpeed+r.cssSpeed;setTimeout(function(){a.removeClass("tiles-animated"),u.cb(a,t)},h)}),t.hide()})},$.fn.tilesSlider=function(e){function o(){var e=s.filter(":last-child"),t=e.prev(),i=e.find("img");n.fade&&t.fadeTo(0,0).fadeTo(n.tilesSpeed,1),n.rewind&&e.delay(n.tileSpeed/2).fadeTo(n.tileSpeed,0),i.trigger("toggleTiles",{cb:function(){e.prependTo(r),i.trigger("toggleTiles",{toggle:!1,reset:!0})}})}var n=$.extend({},t,e);n.slider=!0,n.rewind&&(n.fade=!0);var r=this;r.addClass("tiles-slider-wrap tiles-slider-"+n.effect+" tiles-slider-s"+n.cssSpeed);var i=r.find("img");i.tiles(n);var s=r.find(".tiles-wrap");s.each(function(){$(this).prependTo(r)});var u;return r.on("start",function(e,t){var a=s.filter(":last-child"),f=a.find("img"),l=s.filter(":last-child").find(".tiles-animated").length,c=n.sliderSpeed*(i.length-2)+n.tileSpeed;u&&clearInterval(u),u=setInterval(o,n.sliderSpeed),l?(f.trigger("toggleTiles",{toggle:!1,reset:!0}),a.prependTo(r)):o(),n.loop||setTimeout(function(){r.trigger("stop")},c),t=t||$.noop,setTimeout(t,c)}),r.on("stop",function(){clearInterval(u)}),n.auto&&setTimeout(function(){r.trigger("start")},n.sliderSpeed),r}})();