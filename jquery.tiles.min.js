(function(){function e(e,t,n){var r=(new Array(++t-e)).join(".").split(".").map(function(t,n){return e+n});return n?r.map(function(e){return[Math.random(),e]}).sort().map(function(e){return e[1]}):r}$.wait=function(e){return $.Deferred(function(t){setTimeout(t.resolve,e)})},$.fn.tiles=function(t){var n=$.extend({x:4,y:4,rand:!1,speed:400,cssSpeed:300,effect:"default",reverse:!1,limit:!1,rewind:!1},t);return $("body").addClass("tiles-preload"),$(window).load(function(){$("body").removeClass("tiles-preload")}),this.each(function(){var t=$(this),r="tiles-"+n.effect,i=n.x*n.y;t.is("img")||$.error("Selector can only contain images.");var s=[],u;(new Array(i)).join(".").split(".").forEach(function(e,t){s.push('<div class="tiles-tile '+r+'-normal"/>')}),u=$(s.join(""));var a=$('<div class="tiles-wrap"/>');t.one("load",function(){var e=t.width(),r=t.height();t.wrap(a.width(e).height(r)),u.insertAfter(t),u.css({width:e/n.x,height:r/n.y,backgroundImage:"url("+t.attr("src")+")"}),u.each(function(){var e=$(this),t=e.position();e.css("backgroundPosition",-t.left+"px "+ -t.top+"px")})}),t[0].complete&&t.trigger("load"),t.on("toggleTiles",function(s,a){var f=~~(n.speed/i),l=e(0,i,n.rand);if(n.limit){var c=l.length/(100/n.limit);n.reverse?l.splice(0,c):l.splice(c,l.length)}(n.reverse?l.reverse():l).forEach(function(e,t){function i(){u.eq(e).toggleClass(r+"-toggle")}$.wait(t*f).then(i);if(n.rewind){var s=t*f+n.cssSpeed/(100/n.rewind);$.wait(s).then(i)}}),a=a||$.noop,$.wait(n.speed).then(a(u,t))}),u.addClass("tiles-x"+n.x+" tiles-y"+n.y),u.filter(":odd").addClass("tiles-odd"),u.filter(":even").addClass("tiles-even"),t.hide()})}})();